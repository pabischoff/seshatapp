<html>
<head>
<style>

</style>
</head>


<body>

<p>Choose an NGA</p>
<select id="nga">
  <option value="0">Latium</option>
  <option value="1">Cuzco</option>
  <option value="2">Cahokia</option>
</select>
<p>Choose a variable<p>
<select id="variable">
  <option value="SOCIAL">Social Scale</option>
  <option value="HIERARCHY">Hierarchical Complexity</option>
  <option value="PROFESSIONS">Professions</option>
  <option value="BUREAUCRACY">Bureaucracy characteristics</option>
</select>

<input type="button" onclick="getVar(i)" value="Submit">

<input type="button" onclick="previousPolity()" value="Previous Polity">
<input type="button" onclick="nextPolity()" value="Next Polity">

<p id="polity">Polity</p>
<p id="show_variable">Click Submit to get information for the first polity.</p>
<p id="number">0<p>




 <script>
var i = 0;

function getVar(i) {
		
	var variable = document.getElementById("variable");
	var variableVal = variable.options[variable.selectedIndex].value;
	var nga = document.getElementById("nga");
	var ngaVal = nga.options[nga.selectedIndex].value;
   	var ngaInt = parseInt(ngaVal);
	var xmlhttp = new XMLHttpRequest();
	xmlhttp.open("GET", "seshatapp.xml", true);

    	xmlhttp.onreadystatechange = function() {

        //if (this.readyState == 4 && this.status == 200) {

          	showVar(this, variableVal, ngaInt);
        //}
    };
    	//xmlhttp.open("GET", "https://github.com/pabischoff/seshatapp/blob/master/seshatapp.xml", true);

    	xmlhttp.send();
}

function showVar(xml, variableVal, ngaInt) {
	var xmlDoc = xml.responseXML;
    	var x = xmlDoc.getElementsByTagName("NGA")[ngaInt]; // get NGA
	var y = x.getElementsByTagName(variableVal)[0+i]; // get variable
	var xy = y.childNodes[0];
	var z = x.getElementsByTagName("NAME")[0+i]; // get polity
	var xz = z.childNodes[0];

    	document.getElementById("show_variable").innerHTML = xy.nodeValue; // output variable
	document.getElementById("polity").innerHTML = xz.nodeValue; // output polity
	
	//xz_count = length(z.childNodes);
	//document.getElementById("number").innerHTML = xz_count;
}

function previousPolity() {
  // display the next polity, unless you are on the last polity
	if (i > 0) {    
		i--;
    		getVar(i);
	}
}

function nextPolity() {
  // display the previous polity, unless you are on the first polity 
	if (i < 2) { // THIS MUST BE CHANGED DYNAMICALLY TO ACCOUNT FOR THE MAXIMUM NUMBER OF POLITIES IN A GIVEN NGA
  		i++;
  		getVar(i);
	}
} 
</script> 
</body>
